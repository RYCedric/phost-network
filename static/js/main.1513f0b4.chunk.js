(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{75:function(e,t,c){},77:function(e,t,c){"use strict";c.r(t);var n=c(2),r=c(16),i=c.n(r),s=c(12),a=c.n(s),o=c(14),l=c(3),u=Object(n.createContext)(),j=c(6),d=c.n(j),b=c(9),p=c(5),O=c(22),m=c(36),h=c(1),f=function(){return Object(h.jsx)("div",{className:"left-nav-container",children:Object(h.jsx)("div",{className:"icons",children:Object(h.jsxs)("div",{className:"icons-bis",children:[Object(h.jsx)(b.b,{to:"/",activeClassName:"active-left-nav",children:Object(h.jsx)(O.a,{style:{height:"34px",width:"34px"}})}),Object(h.jsx)(b.b,{to:"/trending",activeClassName:"active-left-nav",children:Object(h.jsx)(m.a,{style:{height:"34px",width:"34px"}})}),Object(h.jsx)(b.b,{to:"/profil",activeClassName:"active-left-nav",children:Object(h.jsx)(O.b,{style:{height:"34px",width:"34px"}})})]})})})},x=c(4),g=c(13),v=c(38),y=function(e){var t=Date.parse(e);return new Date(t).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"long",year:"numeric",month:"short",day:"numeric"}).toString()},w=function(e){return new Date(e).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"long",year:"numeric",month:"short",day:"numeric"}).toString()},N=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},S="GET_POSTS",_="GET_ALL_POSTS",C="LIKE_POST",E="UNLIKE_POST",k="UPDATE_POST",I="DELETE_POST",T="EDIT_COMMENT",R="DELETE_COMMENT",F="GET_TRENDS",L="GET_POST_ERROR",D=function(e){return function(t){return d.a.get("".concat("https://social-media-api.glitch.me/","api/post/")).then((function(c){var n=c.data.slice(0,e);t({type:S,payload:n}),t({type:_,payload:c.data})})).catch((function(e){return console.log(e)}))}},P=function(e){return function(t){return d.a.post("".concat("https://social-media-api.glitch.me/","api/post/"),e).then((function(e){e.data.errors?t({type:L,payload:e.data.errors}):t({type:L,payload:""})}))}},M=function(){var e=Object(n.useState)(!0),t=Object(l.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],j=s[1],d=Object(n.useState)(null),p=Object(l.a)(d,2),O=p[0],m=p[1],f=Object(n.useState)(""),y=Object(l.a)(f,2),S=y[0],_=y[1],C=Object(n.useState)(""),E=Object(l.a)(C,2),k=E[0],I=E[1],T=Object(x.c)((function(e){return e.userReducer})),R=Object(x.c)((function(e){return e.errorReducer.postErrors})),F=Object(x.b)();Object(n.useEffect)((function(){N(T)||r(!1);!function(){for(var e=u.split(" "),t=0;t<e.length;t++)if(e[t].includes("https://www.yout")||e[t].includes("https://yout")){var c=e[t].replace("watch?v=","embed/");_(c.split("&")[0]),e.splice(t,1),j(e.join(" ")),m("")}}()}),[T,u,S]);var L=function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u||O||S)){e.next=12;break}return(t=new FormData).append("posterId",T._id),t.append("message",u),k&&t.append("file",k),t.append("video",S),e.next=8,F(P(t));case 8:F(D()),M(),e.next=13;break;case 12:alert("Veuillez entre un message");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){j(""),m(""),I(""),_("")};return Object(h.jsx)("div",{className:"post-container",children:c?Object(h.jsx)(g.b,{}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"data",children:[Object(h.jsxs)("p",{children:[Object(h.jsxs)("span",{children:[T.following?T.following.length:"0"," "]}),"Abonnement",T.following&&T.following.length>1?"s":null]}),Object(h.jsxs)("p",{children:[Object(h.jsxs)("span",{children:[T.followers?T.followers.length:"0"," "]}),"Abonn\xe9",T.followers&&T.followers.length>1?"s":null]})]}),Object(h.jsx)(b.b,{to:"/profil",children:Object(h.jsx)("div",{className:"user-info",children:Object(h.jsx)("img",{src:T.picture,alt:"user-pic"})})}),Object(h.jsxs)("div",{className:"post-form",children:[Object(h.jsx)("textarea",{name:"message",id:"message",placeholder:"Quoi de neuf ?",onChange:function(e){return j(e.target.value)},value:u}),u||O||S.length>20?Object(h.jsxs)("li",{className:"card-container",children:[Object(h.jsx)("div",{className:"card-left",children:Object(h.jsx)("img",{src:T.picture,alt:"user-pic"})}),Object(h.jsxs)("div",{className:"card-right",children:[Object(h.jsxs)("div",{className:"card-header",children:[Object(h.jsx)("div",{className:"pseudo",children:Object(h.jsx)("h3",{children:T.pseudo})}),Object(h.jsx)("span",{children:w(Date.now())})]}),Object(h.jsxs)("div",{className:"content",children:[Object(h.jsx)("p",{children:u}),Object(h.jsx)("img",{src:O,alt:""}),S&&Object(h.jsx)("iframe",{src:S,frameBorder:"0",allow:"accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture",allowFullScreen:!0,title:S})]})]})]}):null,Object(h.jsxs)("div",{className:"footer-form",children:[Object(h.jsxs)("div",{className:"icon",children:[N(S)&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(v.a,{style:{cursor:"pointer"}}),Object(h.jsx)("input",{type:"file",id:"file-upload",name:"file",accept:".jpg,.jpeg,.png",onChange:function(e){return function(e){m(URL.createObjectURL(e.target.files[0])),I(e.target.files[0]),_("")}(e)}})]}),S&&Object(h.jsx)("button",{onClick:function(){return _("")},children:"Supprimer video"})]}),!N(R.format)&&Object(h.jsx)("p",{children:R.format}),!N(R.maxSize)&&Object(h.jsx)("p",{children:R.maxSize}),Object(h.jsxs)("div",{className:"btn-send",children:[u||O||S.length>20?Object(h.jsx)("button",{className:"cancel",onClick:M,children:"Annuler message"}):null,Object(h.jsx)("button",{className:"send",onClick:L,children:"Envoyer"})]})]})]})]})})},U="GET_USER",A="UPLOAD_PICTURE",z="UPDATE_BIO",V="FOLLOW_USER",H="UNFOLLOW_USER",B="GET_USER_ERROR",q=c(15),G=function(e){var t=e.idToFollow,c=e.type,r=Object(n.useState)(!1),i=Object(l.a)(r,2),s=i[0],a=i[1],o=Object(x.c)((function(e){return e.userReducer})),u=Object(x.b)();return Object(n.useEffect)((function(){N(o.following)||(o.following.includes(t)?a(!0):a(!1))}),[o,t]),Object(h.jsxs)(h.Fragment,{children:[s&&!N(o)&&Object(h.jsxs)("span",{onClick:function(){var e,c;u((e=o._id,c=t,function(t){return d()({method:"patch",url:"".concat("https://social-media-api.glitch.me/","api/user/unFollow/").concat(e),data:{idToUnfollow:c}}).then((function(e){return t({type:H,payload:{idToUnfollow:c}})})).catch((function(e){return console.log(e)}))})),a(!1)},children:["suggestion"===c&&Object(h.jsx)("button",{className:"unfollow-btn",children:"Abonn\xe9"}),"card"===c&&Object(h.jsx)(q.c,{style:{marginLeft:"10px",cursor:"pointer",marginTop:"5px"}})]}),!1===s&&!N(o)&&Object(h.jsxs)("span",{onClick:function(){u(function(e,t){return function(c){return d()({method:"patch",url:"".concat("https://social-media-api.glitch.me/","api/user/follow/").concat(e),data:{idToFollow:t}}).then((function(e){return c({type:V,payload:{idToFollow:t}})})).catch((function(e){return console.log(e)}))}}(o._id,t)),a(!0)},children:["suggestion"===c&&Object(h.jsx)("button",{className:"unfollow-btn",children:"Suivre"}),"card"===c&&Object(h.jsx)(q.d,{style:{marginLeft:"10px",cursor:"pointer",marginTop:"5px"}})]})]})},J=c(25),W=c(24),K=c(39),Q=(c(74),function(e){var t=e.post,c=Object(n.useState)(!1),r=Object(l.a)(c,2),i=r[0],s=r[1],a=Object(n.useContext)(u),o=Object(x.b)();Object(n.useEffect)((function(){t.likers.includes(a)?s(!0):s(!1)}),[a,t.likers,i]);return Object(h.jsxs)("div",{className:"like-container",children:[null===a&&Object(h.jsx)(K.a,{trigger:Object(h.jsx)(W.a,{}),position:"bottom left",closeOnDocumentClick:!0,children:Object(h.jsx)("div",{children:"Connectez-vous pour aimer un post !"})}),a&&!1===i&&Object(h.jsx)(W.a,{onClick:function(){var e,c;o((e=t._id,c=a,function(t){return d()({method:"patch",url:"".concat("https://social-media-api.glitch.me/","api/post/like-post/").concat(e),data:{id:c}}).then((function(n){return t({type:C,payload:{postId:e,userId:c}})})).catch((function(e){return console.log(e)}))})),s(!0)},style:{cursor:"pointer"}}),a&&i&&Object(h.jsx)(W.b,{onClick:function(){var e,c;o((e=t._id,c=a,function(t){return d()({method:"patch",url:"".concat("https://social-media-api.glitch.me/","api/post/unlike-post/").concat(e),data:{id:c}}).then((function(n){return t({type:E,payload:{postId:e,userId:c}})})).catch((function(e){return console.log(e)}))})),s(!1)},style:{cursor:"pointer"}}),Object(h.jsx)("span",{children:t.likers.length})]})}),X=function(e){var t=e.id,c=Object(x.b)(),n=function(){return c((e=t,function(t){return d()({method:"delete",url:"".concat("https://social-media-api.glitch.me/","api/post/").concat(e)}).then((function(){t({type:I,payload:{postId:e}})})).catch((function(e){return console.log(e)}))}));var e};return Object(h.jsx)("div",{onClick:function(){window.confirm("Voulez-vous supprimer cet article ?")&&n()},children:Object(h.jsx)(g.c,{})})},Y=function(e){var t=e.comment,c=e.postId,r=Object(n.useState)(!1),i=Object(l.a)(r,2),s=i[0],a=i[1],o=Object(n.useState)(!1),j=Object(l.a)(o,2),b=j[0],p=j[1],O=Object(n.useState)(""),m=Object(l.a)(O,2),f=m[0],v=m[1],y=Object(n.useContext)(u),w=Object(x.b)(),N=function(){return w(function(e,t){return function(c){return d()({method:"patch",url:"".concat("https://social-media-api.glitch.me/","api/post/delete-comment-post/").concat(e),data:{commentId:t}}).then((function(){c({type:R,payload:{postId:e,commentId:t}})})).catch((function(e){return console.log(e)}))}}(c,t._id))};return Object(n.useEffect)((function(){y===t.commenterId&&a(!0)}),[y,t.commenterId]),Object(h.jsxs)("div",{className:"edit-comment",children:[s&&!1===b&&Object(h.jsx)("span",{onClick:function(){return p(!b)},children:Object(h.jsx)(g.a,{})}),s&&b&&Object(h.jsxs)("form",{action:"",onSubmit:function(e){e.preventDefault(),f&&(w(function(e,t,c){return function(n){return d()({method:"patch",url:"".concat("https://social-media-api.glitch.me/","api/post/edit-comment-post/").concat(e),data:{text:c,commentId:t}}).then((function(){n({type:T,payload:{postId:e,commentId:t,text:c}})})).catch((function(e){return console.log(e)}))}}(c,t._id,f)),v(""),p(!1))},className:"edit-comment-form",children:[Object(h.jsx)("label",{htmlFor:"text",onClick:function(){return p(!b)},children:"Editer"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",name:"text",onChange:function(e){v(e.target.value)},defaultValue:t.text}),Object(h.jsx)("br",{}),Object(h.jsxs)("div",{className:"btn",children:[Object(h.jsx)(g.c,{style:{cursor:"pointer",marginRight:"5px"},onClick:function(){window.confirm("Voulez-vous supprimer ce commentaire ?")&&N()}}),Object(h.jsx)("input",{type:"submit",value:"Valider modification"})]})]})]})},Z=function(e){var t=e.post,c=Object(n.useState)(""),r=Object(l.a)(c,2),i=r[0],s=r[1],a=Object(x.c)((function(e){return e.usersReducer})),o=Object(x.c)((function(e){return e.userReducer})),u=Object(x.b)();return Object(h.jsxs)("div",{className:"comments-container",children:[t.comments.map((function(e){return Object(h.jsxs)("div",{className:e.commenterId===o._id?"comment-container client":"comment-container",children:[Object(h.jsx)("div",{className:"left-part",children:Object(h.jsx)("img",{src:!N(a[0])&&a.map((function(t){return t._id===e.commenterId?t.picture:null})).join(""),alt:"commenter-pic"})}),Object(h.jsxs)("div",{className:"right-part",children:[Object(h.jsxs)("div",{className:"comment-header",children:[Object(h.jsxs)("div",{className:"pseudo",children:[Object(h.jsx)("h3",{children:e.commenterPseudo}),e.commenterId!==o._id&&Object(h.jsx)(G,{idToFollow:e.commenterId,type:"card"})]}),Object(h.jsx)("span",{children:w(e.timestamp)})]}),Object(h.jsx)("p",{children:e.text}),Object(h.jsx)(Y,{comment:e,postId:t._id})]})]},e._id)})),o._id&&Object(h.jsxs)("form",{action:"",onSubmit:function(e){e.preventDefault(),i&&u(function(e,t,c,n){return function(r){return d()({method:"patch",url:"".concat("https://social-media-api.glitch.me/","api/post/comment-post/").concat(e),data:{text:c,commenterPseudo:n,commenterId:t}}).then((function(){r({type:"ADD_COMMENT",payload:{postId:e}})})).catch((function(e){return console.log(e)}))}}(t._id,o._id,i,o.pseudo)).then((function(){return u(D()).then((function(){return s("")}))}))},className:"comment-form",children:[Object(h.jsx)("input",{type:"text",name:"text",onChange:function(e){return s(e.target.value)},value:i,placeholder:"Laisser un commentaire"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"submit",value:"Commenter"})]})]})},$=function(e){var t=e.post,c=Object(n.useState)(!0),r=Object(l.a)(c,2),i=r[0],s=r[1],a=Object(n.useState)(!1),o=Object(l.a)(a,2),u=o[0],j=o[1],b=Object(n.useState)(null),p=Object(l.a)(b,2),O=p[0],m=p[1],f=Object(n.useState)(!1),v=Object(l.a)(f,2),w=v[0],S=v[1],_=Object(x.c)((function(e){return e.usersReducer})),C=Object(x.c)((function(e){return e.userReducer})),E=Object(x.b)();Object(n.useEffect)((function(){!N(_[0])&&s(!1)}),[_]);return Object(h.jsx)("li",{className:"card-container",children:i?Object(h.jsx)("i",{className:" fas fa-spinner fa-spin",children:Object(h.jsx)(g.b,{})}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"card-left",children:Object(h.jsx)("img",{src:!N(_[0])&&_.map((function(e){return e._id===t.posterId?e.picture:null})).join(""),alt:"user-pic"})}),Object(h.jsxs)("div",{className:"card-right",children:[Object(h.jsxs)("div",{className:"card-header",children:[Object(h.jsxs)("div",{className:"pseudo",children:[Object(h.jsx)("h3",{children:!N(_[0])&&_.map((function(e){return e._id===t.posterId?e.pseudo:null})).join("")}),t.posterId!==C._id&&Object(h.jsx)(G,{idToFollow:t.posterId,type:"card"})]}),Object(h.jsx)("span",{children:y(t.createdAt)})]}),!1===u&&Object(h.jsx)("p",{children:t.message}),u&&Object(h.jsxs)("div",{className:"update-post",children:[Object(h.jsx)("textarea",{defaultValue:t.message,onChange:function(e){m(e.target.value)}}),Object(h.jsx)("div",{className:"button-container",onClick:function(){var e,c;O&&E((e=t._id,c=O,function(t){return d()({method:"put",url:"".concat("https://social-media-api.glitch.me/","api/post/").concat(e),data:{message:c}}).then((function(){t({type:k,payload:{message:c,postId:e}})})).catch((function(e){return console.log(e)}))})),j(!1)},children:Object(h.jsx)("button",{className:"btn",children:"Valider Modification"})})]}),t.picture&&Object(h.jsx)("img",{src:t.picture,alt:"card-pic",className:"card-pic"}),t.video&&Object(h.jsx)("iframe",{src:t.video,width:"300",height:"3OO",frameBorder:"0",allow:"accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture",allowFullScreen:!0,title:t._id}),C._id===t.posterId&&Object(h.jsxs)("div",{className:"button-container",children:[Object(h.jsx)("div",{onClick:function(){return j(!u)},children:Object(h.jsx)(J.a,{})}),Object(h.jsx)(X,{id:t._id})]}),Object(h.jsxs)("div",{className:"card-footer",children:[Object(h.jsxs)("div",{className:"comment-icon",children:[Object(h.jsx)("div",{className:"icon",children:Object(h.jsx)(J.b,{onClick:function(){return S(!w)}})}),Object(h.jsx)("span",{children:t.comments.length})]}),Object(h.jsx)(Q,{post:t}),Object(h.jsx)("div",{className:"icon",children:Object(h.jsx)(J.c,{})})]}),w&&Object(h.jsx)(Z,{post:t})]})]})},t._id)},ee=function(){var e=Object(n.useState)(!0),t=Object(l.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(5),s=Object(l.a)(i,2),a=s[0],o=s[1],u=Object(x.b)(),j=Object(x.c)((function(e){return e.postsReducer})),d=function(){window.innerHeight+document.documentElement.scrollTop+1>document.scrollingElement.scrollHeight&&r(!0)};return Object(n.useEffect)((function(){return c&&(u(D(a)),r(!1),o(a+5)),window.addEventListener("scroll",d),function(){return window.removeEventListener("scroll",d)}}),[c,u,a]),Object(h.jsx)("div",{className:"thread-container",children:Object(h.jsx)("ul",{children:!N(j[0])&&j.map((function(e){return Object(h.jsx)($,{post:e},e._id)}))})})},te=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(""),s=Object(l.a)(i,2),a=s[0],o=s[1];return Object(h.jsxs)("form",{action:"",onSubmit:function(e){e.preventDefault();var t=document.querySelector(".email.error"),n=document.querySelector(".password.error");d()({method:"post",url:"".concat("https://social-media-api.glitch.me/","api/user/login"),withCredentials:!0,data:{email:c,password:a}}).then((function(e){e.data.errors?(t.innerHTML=e.data.errors.email,n.innerHTML=e.data.errors.password):window.location="/"})).catch((function(e){return console.log(e)}))},id:"sign-in-form",children:[Object(h.jsx)("label",{htmlFor:"email",children:"Email"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",name:"email",id:"email",onChange:function(e){return r(e.target.value)},value:c}),Object(h.jsx)("div",{className:"email error"}),Object(h.jsx)("br",{}),Object(h.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"password",name:"password",id:"password",onChange:function(e){return o(e.target.value)},value:a}),Object(h.jsx)("div",{className:"password error"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"submit",value:"Se connecter"})]})},ce=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],j=s[1],b=Object(n.useState)(""),p=Object(l.a)(b,2),O=p[0],m=p[1],f=Object(n.useState)(""),x=Object(l.a)(f,2),g=x[0],v=x[1],y=Object(n.useState)(""),w=Object(l.a)(y,2),N=w[0],S=w[1],_=function(){var e=Object(o.a)(a.a.mark((function e(t){var c,n,i,s,o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c=document.getElementById("terms"),n=document.querySelector(".pseudo.error"),i=document.querySelector(".email.error"),s=document.querySelector(".password.error"),o=document.querySelector(".password-confim.error"),l=document.querySelector(".terms.error"),g===N&&c.checked){e.next=12;break}g!==N&&(o.innerHTML="Les mots de passe ne correspondent pas"),c.checked||(l.innerHTML="Veuillez valider les conditions g\xe9n\xe9rales"),e.next=14;break;case 12:return e.next=14,d()({method:"post",url:"".concat("https://social-media-api.glitch.me/","api/user/register"),data:{pseudo:u,email:O,password:g}}).then((function(e){e.data.errors?(n.innerHTML=e.data.errors.pseudo,i.innerHTML=e.data.errors.email,s.innerHTML=e.data.errors.password):r(!0)})).catch((function(e){return console.log(e)}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:c?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(te,{}),Object(h.jsx)("span",{}),Object(h.jsx)("h4",{className:"success",children:"Enregistrement r\xe9ussi, veuillez-vous connecter"})]}):Object(h.jsxs)("form",{action:"",onSubmit:_,id:"sign-up-form",children:[Object(h.jsx)("label",{htmlFor:"pseudo",children:"Pseudo"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",name:"pseudo",id:"pseudo",onChange:function(e){return j(e.target.value)},value:u}),Object(h.jsx)("div",{className:"pseudo error"}),Object(h.jsx)("br",{}),Object(h.jsx)("label",{htmlFor:"email",children:"Email"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",name:"email",id:"email",onChange:function(e){return m(e.target.value)},value:O}),Object(h.jsx)("div",{className:"email error"}),Object(h.jsx)("br",{}),Object(h.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"password",name:"password",id:"password",onChange:function(e){return v(e.target.value)},value:g}),Object(h.jsx)("div",{className:"password error"}),Object(h.jsx)("br",{}),Object(h.jsx)("label",{htmlFor:"password-conf",children:"Confirmer mot de passe"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"password",name:"password-conf",id:"password-conf",onChange:function(e){return S(e.target.value)},value:N}),Object(h.jsx)("div",{className:"password-confirm error"}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"checkbox",id:"terms"}),Object(h.jsxs)("label",{htmlFor:"terms",children:["J'accepte les"," ",Object(h.jsx)("a",{href:"http:/",target:"_blank",rel:"noopener noreferrer",children:"conditions g\xe9n\xe9rales"})]}),Object(h.jsx)("div",{className:"terms error"}),Object(h.jsx)("input",{type:"submit",value:"Valider inscription"})]})})},ne=function(e){var t=e.signin,c=e.signup,r=Object(n.useState)(c),i=Object(l.a)(r,2),s=i[0],a=i[1],o=Object(n.useState)(t),u=Object(l.a)(o,2),j=u[0],d=u[1],b=function(e){"login"===e.target.id&&(d(!0),a(!1)),"register"===e.target.id&&(d(!1),a(!0))};return Object(h.jsx)("div",{className:"connection-form",children:Object(h.jsxs)("div",{className:"form-container",children:[Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{onClick:b,id:"register",className:s?"active-btn":null,children:"S'inscrire"}),Object(h.jsx)("li",{onClick:b,id:"login",className:j?"active-btn":null,children:"Se connecter"})]}),j&&Object(h.jsx)(te,{}),s&&Object(h.jsx)(ce,{})]})})},re=function(){var e=Object(x.c)((function(e){return e.allPostsReducer})),t=Object(x.c)((function(e){return e.usersReducer})),c=Object(x.c)((function(e){return e.trendingReducer})),r=Object(x.b)();return Object(n.useEffect)((function(){if(!N(e[0])){var t=Object.keys(e).map((function(t){return e[t]})).sort((function(e,t){return t.likers.length-e.likers.length}));t.length=3,r(function(e){return function(t){t({type:F,payload:e})}}(t))}}),[e,r]),Object(h.jsxs)("div",{className:"trending-container",children:[Object(h.jsx)("h4",{children:"Trending "}),Object(h.jsx)(b.b,{to:"/trending",children:Object(h.jsx)("ul",{children:c.length&&c.map((function(e){return Object(h.jsxs)("li",{children:[Object(h.jsxs)("div",{children:[e.picture&&Object(h.jsx)("img",{src:e.picture,alt:"post-pic"}),e.video&&Object(h.jsx)("iframe",{src:e.video,width:"300",height:"3OO",frameBorder:"0",allow:"accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture",allowFullScreen:!0,title:e._id}),N(e.picture)&&N(e.video)&&Object(h.jsx)("img",{src:t[0]&&t.map((function(t){return t._id===e.posterId?t.picture:null})).join(""),alt:"user-pic"})]}),Object(h.jsxs)("div",{className:"trend-content",children:[Object(h.jsx)("p",{children:e.message}),Object(h.jsx)("span",{children:"Lire"})]})]},e._id)}))})})]})},ie=function(){var e=Object(n.useContext)(u);return Object(h.jsxs)("div",{className:"home",children:[Object(h.jsx)(f,{}),Object(h.jsxs)("div",{className:"main",children:[Object(h.jsx)("div",{className:"home-header",children:e?Object(h.jsx)(M,{}):Object(h.jsx)(ne,{signin:!0,signup:!1})}),Object(h.jsx)(ee,{})]}),Object(h.jsx)("div",{className:"right-side",children:Object(h.jsx)("div",{className:"right-side-container",children:Object(h.jsx)("div",{className:"wrapper",children:Object(h.jsx)(re,{})})})})]})},se=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),c=t[0],r=t[1],i=Object(x.b)(),s=Object(x.c)((function(e){return e.userReducer}));return Object(h.jsxs)("form",{action:"",onSubmit:function(e){e.preventDefault();var t=new FormData;t.append("name",s.pseudo),t.append("userId",s._id),t.append("file",c),i(function(e,t){return function(c){return d.a.post("".concat("https://social-media-api.glitch.me/","api/user/upload"),e).then((function(e){if(!e.data.errors)return c({type:B,payload:""}),d.a.get("".concat("https://social-media-api.glitch.me/","api/user/").concat(t)).then((function(e){c({type:A,payload:e.data.picture})}));c({type:B,payload:e.data.errors})})).catch((function(e){return console.log(e)}))}}(t,s._id))},className:"upload-pic",children:[Object(h.jsx)("label",{htmlFor:"file",children:"Changer d'image"}),Object(h.jsx)("input",{type:"file",id:"file",name:"file",accept:".jpg, .jpeg, .png",onChange:function(e){return r(e.target.files[0])}}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"submit",value:"Envoyer"})]})},ae=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(!1),s=Object(l.a)(i,2),a=s[0],o=s[1],u=Object(n.useState)(!1),j=Object(l.a)(u,2),b=j[0],p=j[1],O=Object(n.useState)(!1),m=Object(l.a)(O,2),g=m[0],v=m[1],w=Object(x.c)((function(e){return e.userReducer})),S=Object(x.c)((function(e){return e.usersReducer})),_=Object(x.c)((function(e){return e.errorReducer.userErrors})),C=Object(x.b)();return Object(h.jsxs)("div",{className:"profil-container",children:[Object(h.jsx)(f,{}),Object(h.jsxs)("h1",{children:["Profil de ",w.pseudo]}),Object(h.jsxs)("div",{className:"update-container",children:[Object(h.jsxs)("div",{className:"left-part",children:[Object(h.jsx)("h3",{children:"Photo de profil"}),Object(h.jsx)("img",{src:w.picture,alt:"user-pic"}),Object(h.jsx)(se,{}),!N(_.format)&&Object(h.jsx)("p",{children:_.format}),!N(_.maxSize)&&Object(h.jsx)("p",{children:_.maxSize})]}),Object(h.jsxs)("div",{className:"right-part",children:[Object(h.jsxs)("div",{className:"bio-update",children:[Object(h.jsx)("h3",{children:"Bio"}),!1===a&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("p",{onClick:function(){o(!a)},children:w.bio}),Object(h.jsx)("button",{onClick:function(){o(!a)},children:"Modifier bio"})]}),a&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("textarea",{defaultValue:w.bio,onChange:function(e){return r(e.target.value)}}),Object(h.jsx)("button",{onClick:function(){C(function(e,t){return function(c){return d()({method:"put",url:"".concat("https://social-media-api.glitch.me/","api/user/").concat(e),data:{bio:t}}).then((function(e){c({type:z,payload:t})})).catch((function(e){return console.log(e)}))}}(w._id,c)),o(!1)},children:"valider modifications"})]})]}),Object(h.jsxs)("h4",{children:["Membre depuis le : ",y(w.createdAt)]}),Object(h.jsxs)("h5",{onClick:function(){return p(!0)},children:["Abonnements : ",w.following?w.following.length:"0"]}),Object(h.jsxs)("h5",{onClick:function(){return v(!0)},children:["Abonn\xe9s : ",w.followers?w.followers.length:"0"]})]})]}),b&&Object(h.jsx)("div",{className:"popup-profil-container",children:Object(h.jsxs)("div",{className:"modal",children:[Object(h.jsx)("h3",{children:"Abonnements"}),Object(h.jsx)("span",{className:"cross",onClick:function(){return p(!1)},children:"\u2715"}),Object(h.jsx)("ul",{children:S.map((function(e){for(var t=0;t<w.following.length;t++)if(e._id===w.following[t])return Object(h.jsxs)("li",{children:[Object(h.jsx)("img",{src:e.picture,alt:"user-pic"}),Object(h.jsx)("h4",{children:e.pseudo}),Object(h.jsx)("div",{className:"follow-handler",children:Object(h.jsx)(G,{idToFollow:e._id,type:"suggestion"})})]},e._id);return null}))})]})}),g&&Object(h.jsx)("div",{className:"popup-profil-container",children:Object(h.jsxs)("div",{className:"modal",children:[Object(h.jsx)("h3",{children:"Abonn\xe9s"}),Object(h.jsx)("span",{className:"cross",onClick:function(){return v(!1)},children:"\u2715"}),Object(h.jsx)("ul",{children:S.map((function(e){for(var t=0;t<w.followers.length;t++)if(e._id===w.followers[t])return Object(h.jsxs)("li",{children:[Object(h.jsx)("img",{src:e.picture,alt:"user-pic"}),Object(h.jsx)("h4",{children:e.pseudo}),Object(h.jsx)("div",{className:"follow-handler",children:Object(h.jsx)(G,{idToFollow:e._id,type:"suggestion"})})]},e._id);return null}))})]})})]})},oe=function(){var e=Object(n.useContext)(u);return Object(h.jsx)("div",{className:"profil-page",children:e?Object(h.jsx)(ae,{}):Object(h.jsxs)("div",{className:"log-container",children:[Object(h.jsx)(ne,{signin:!1,signup:!0}),Object(h.jsx)("div",{className:"img-container",children:Object(h.jsx)("img",{src:"./img/log.svg",alt:"img-log"})})]})})},le=function(){Object(n.useContext)(u);var e=Object(x.c)((function(e){return e.trendingReducer}));return Object(h.jsxs)("div",{className:"trending-page",children:[Object(h.jsx)(f,{}),Object(h.jsx)("div",{className:"main",children:Object(h.jsx)("ul",{children:!N(e[0])&&e.map((function(e){return Object(h.jsx)($,{post:e},e._id)}))})}),Object(h.jsx)("div",{className:"right-side",children:Object(h.jsx)("div",{className:"right-side-container",children:Object(h.jsx)(re,{})})})]})},ue=function(){return Object(h.jsx)("div",{children:Object(h.jsx)("h1",{children:"Erreur 404"})})},je=c(40),de=c.n(je),be=function(){var e=function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({method:"get",url:"".concat("https://social-media-api.glitch.me/","api/user/logout"),withCredentials:!0}).then((function(){var e;e="jwt","undefined"!==window&&de.a.remove(e,{expires:1})})).catch((function(e){return console.log(e)}));case 2:window.location="/";case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)("li",{onClick:e,children:Object(h.jsx)(q.b,{style:{cursor:"pointer"}})})},pe=function(){var e=Object(n.useContext)(u),t=Object(x.c)((function(e){return e.userReducer}));return Object(h.jsx)("nav",{children:Object(h.jsxs)("div",{className:"nav-container",children:[Object(h.jsx)("div",{className:"logo",children:Object(h.jsx)(b.b,{to:"/",children:Object(h.jsxs)("div",{className:"logo",children:[Object(h.jsx)("img",{src:"./img/logo.png",alt:"icon"}),Object(h.jsx)("h3",{children:"Phost"})]})})}),e?Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{}),Object(h.jsx)("li",{className:"welcome",children:Object(h.jsx)(b.b,{to:"/profil",children:Object(h.jsxs)("h5",{children:["Bienvenue ",t.pseudo]})})}),Object(h.jsx)(be,{})]}):Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{}),Object(h.jsx)("li",{children:Object(h.jsx)(b.b,{to:"/profil",children:Object(h.jsx)(q.a,{})})})]})]})})},Oe=function(){return Object(h.jsxs)(b.a,{children:[Object(h.jsx)(pe,{}),Object(h.jsxs)(p.c,{children:[Object(h.jsx)(p.a,{path:"/",element:Object(h.jsx)(ie,{})}),Object(h.jsx)(p.a,{path:"/profil",element:Object(h.jsx)(oe,{})}),Object(h.jsx)(p.a,{path:"/trending",element:Object(h.jsx)(le,{})}),Object(h.jsx)(p.a,{path:"*",element:Object(h.jsx)(ue,{})})]})]})},me=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),c=t[0],r=t[1],i=Object(x.b)();return Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({method:"get",url:"".concat("https://social-media-api.glitch.me/","jwtid"),withCredentials:!0}).then((function(e){return r(e.data)})).catch((function(e){return console.log("No token")}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),c&&i(function(e){return function(t){return d.a.get("".concat("https://social-media-api.glitch.me/","api/user/").concat(e)).then((function(e){t({type:U,payload:e.data})})).catch((function(e){return console.log(e)}))}}(c))}),[c,i]),Object(h.jsx)(u.Provider,{value:c,children:Object(h.jsx)(Oe,{})})},he=(c(75),c(18)),fe=c(43),xe=c(23),ge=c(7),ve={};var ye="GET_USERS",we={};var Ne={};var Se={userErrors:[],postErrors:[]};var _e={};var Ce={};var Ee=Object(he.combineReducers)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return t.payload;case A:return Object(ge.a)(Object(ge.a)({},e),{},{picture:t.payload});case z:return Object(ge.a)(Object(ge.a)({},e),{},{bio:t.payload});case V:return Object(ge.a)(Object(ge.a)({},e),{},{following:[t.payload.idToFollow].concat(Object(xe.a)(e.following))});case H:return Object(ge.a)(Object(ge.a)({},e),{},{following:e.following.filter((function(e){return e!==t.payload.idToUnfollow}))});default:return e}},usersReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;return t.type===ye?t.payload:e},postsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return t.payload;case C:return e.map((function(e){return e._id===t.payload.postId?Object(ge.a)(Object(ge.a)({},e),{},{likers:[t.payload.userId].concat(Object(xe.a)(e.likers))}):e}));case E:return e.map((function(e){return e._id===t.payload.postId?Object(ge.a)(Object(ge.a)({},e),{},{likers:e.likers.filter((function(e){return e!==t.payload.userId}))}):e}));case k:return e.map((function(e){return e._id===t.payload.postId?Object(ge.a)(Object(ge.a)({},e),{},{message:t.payload.message}):e}));case I:return e.filter((function(e){return e._id!==t.payload.postId}));case T:return e.map((function(e){return e._id===t.payload.postId?Object(ge.a)(Object(ge.a)({},e),{},{comments:e.comments.map((function(e){return e._id===t.payload.commentId?Object(ge.a)(Object(ge.a)({},e),{},{text:t.payload.text}):e}))}):e}));case R:return e.map((function(e){return e._id===t.payload.postId?Object(ge.a)(Object(ge.a)({},e),{},{comments:e.comments.filter((function(e){return e._id!==t.payload.commentId}))}):e}));default:return e}},errorReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return{postErrors:t.payload,userErrors:[]};case B:return{userErrors:t.payload,postErrors:[]};default:return e}},allPostsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;return t.type===_?t.payload:e},trendingReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;return t.type===F?t.payload:e}}),ke=c(41),Ie=c(42),Te=c.n(Ie),Re=Object(he.createStore)(Ee,Object(ke.composeWithDevTools)(Object(he.applyMiddleware)(fe.a,Te.a)));Re.dispatch((function(e){return d()({method:"get",url:"".concat("https://social-media-api.glitch.me/","api/user")}).then((function(t){return e({type:ye,payload:t.data})})).catch((function(e){return console.log(e)}))})),Re.dispatch(D()),console.log("https://social-media-api.glitch.me/"),i.a.render(Object(h.jsx)(x.a,{store:Re,children:Object(h.jsx)(me,{})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.1513f0b4.chunk.js.map